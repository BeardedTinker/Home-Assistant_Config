#####
# Lock tempate for Nuki
# https://www.home-assistant.io/integrations/lock.template/
#####

lock:
  - platform: template
    name: "Nuki Lock Action"
    unique_id: nuki_lock_action
    value_template: >
      {{ states('input_number.nuki_bridge_lock_sensor_state') | int == 1 if states('input_number.nuki_bridge_lock_sensor_state') | int != 'unknown' }}
    availability_template: >
      {{ states('input_text.nuki_bridge_lock_sensor') != 'unknown' }}
    lock:
      service: rest_command.nuki_lock_action
      data:
        action: >
          {{ state_attr('input_select.nuki_choose_lock_action','options').index(states('input_select.nuki_choose_lock_action')) + 1 }}
    unlock:
      service: rest_command.nuki_lock_action
      data:
        action: >
          {{ state_attr('input_select.nuki_choose_unlock_action','options').index(states('input_select.nuki_choose_unlock_action')) + 1 }}

